#!/usr/bin/env python

##### EXPLORING DATASETS IN WEEK 1 DOCUMENTATION ##### Inefficient code. Completed in Jupyter Notebook. ASK how to show code in Jupyter Notebook format.

import matplotlib.pyplot as plt; import numpy as np; import netCDF4; from netCDF4 import Dataset
import pandas as pd; import numpy.ma as ma; import time as timeit; import os; import math
import itertools; import scipy.io; import mat73 
%matplotlib inline

### The years are maleable. 
### For 2015 to 2019 data, set range 2015 to 2020 and set year = 2015.
### For 2012 and 2014 data, set range 2012 to 2013 and range 2014 to 2015 respectively.
###### I don't know what to do with the v7.3 files. ASK. 

# Try with summer months considered to be days 200 to 290 approximately. 
season_start_day = 200
season_end_day = 290

year = 1977
for year in range(1977,1978): # to 2010
    filename = 'casts_{}.mat'.format(year)
    file = scipy.io.loadmat(filename,squeeze_me=True)
    npfile = file['casts_{}'.format(year)]
    for i in range(len(npfile)):
        if npfile[i][4] > season_start_day and npfile[i][4] < season_end_day: 
            print('year:', year, 'day:', npfile[i][4],'depth:', npfile[i][6])
            plt.style.use('ggplot') ### Plotting temperature and salinity plots        
            plt.subplot(1, 3, 1)
            plt.plot(npfile[i][11],npfile[i][12]*-1,color='blue')
            plt.xlabel('Temperature')
            plt.ylabel('Pressure')        
            plt.subplot(1, 3, 2)
            plt.plot(npfile[i][10],npfile[i][12]*-1,color='red')
            plt.xlabel('Salinity')
            plt.ylabel('Pressure')
            plt.tight_layout()
            plt.show()
            plt.subplot(1, 3, 3)
            ax = plt.axes(projection=ccrs.PlateCarree())
            ax.set_extent([-78, -65, 34, 44.5], ccrs.PlateCarree())
            ax.add_feature(cartopy.feature.COASTLINE, linewidth=1.5)
            gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True,linewidth=1, color='gray', alpha=0.5, linestyle='--')
            gl.xlabels_top = False
            gl.ylabels_left = False
            gl.xformatter = LONGITUDE_FORMATTER
            gl.yformatter = LATITUDE_FORMATTER
            ax.scatter([npfile[i][2]*-1],[npfile[i][1]],transform=ccrs.PlateCarree())
            plt.show()
        else:
            pass

mat2012 = scipy.io.loadmat('casts_2012.mat')
mat2014 = scipy.io.loadmat('casts_2012.mat')
# files for 2011 and 2013 are v7.3 files. All others are scipy readable.

# ---------------------------------------------------------------------------------------------------------------------#
